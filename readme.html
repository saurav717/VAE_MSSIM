<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <meta property="og:image" content="http://wiseodd.github.io/img/bayes.png">
    

    <meta property="og:description" content="Variational Autoencoder (VAE) (Kingma et al., 2013) is a new perspective in the autoencoding business. It views Autoencoder as a bayesian inference problem: modeling the underlying probability distribution of data.">

    <title>Variational Autoencoder: Intuition and Implementation - Agustinus Kristiadi's Blog</title>

    <link rel="shortcut icon" type="image/png" href="https://wiseodd.github.io/favicon.png">

    <link rel="canonical" href="http://wiseodd.github.io/techblog/2016/12/10/variational-autoencoder/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="readme_files/bootstrap.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="readme_files/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="readme_files/syntax.css">

    <!-- Custom Fonts -->
    <link href="readme_files/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="readme_files/css.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {display: block; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style></head><body><div id="MathJax_Message" style="display: none;"></div><p style="display: none">
        <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot; /&gt;" role="presentation"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-1">
            \newcommand{\dint}{\text{d}}
            \newcommand{\vphi}{\boldsymbol{\phi}}
            \newcommand{\vpi}{\boldsymbol{\pi}}
            \newcommand{\vpsi}{\boldsymbol{\psi}}
            \newcommand{\vomg}{\boldsymbol{\omega}}
            \newcommand{\vsigma}{\boldsymbol{\sigma}}
            \newcommand{\vzeta}{\boldsymbol{\zeta}}
            \renewcommand{\vx}{\mathbf{x}}
            \renewcommand{\vy}{\mathbf{y}}
            \renewcommand{\vz}{\mathbf{z}}
            \renewcommand{\vh}{\mathbf{h}}
            \renewcommand{\b}{\mathbf}
            \renewcommand{\vec}{\text{vec}}
            \newcommand{\vecemph}{\text{\emph{vec}}}
            \newcommand{\mvn}{\mathcal{MN}}
            \newcommand{\G}{\mathcal{G}}
            \newcommand{\M}{\mathcal{M}}
            \newcommand{\N}{\mathcal{N}}
            \newcommand{\S}{\mathcal{S}}
            \newcommand{\diag}[1]{\text{diag}(#1)}
            \newcommand{\diagemph}[1]{\text{\emph{diag}}(#1)}
            \newcommand{\tr}[1]{\text{tr}(#1)}
            \renewcommand{\C}{\mathbb{C}}
            \renewcommand{\R}{\mathbb{R}}
            \renewcommand{\E}{\mathbb{E}}
            \newcommand{\D}{\mathcal{D}}
            \newcommand{\inner}[1]{\langle #1 \rangle}
            \newcommand{\innerbig}[1]{\left \langle #1 \right \rangle}
            \newcommand{\abs}[1]{\lvert #1 \rvert}
            \newcommand{\norm}[1]{\lVert #1 \rVert}
            \newcommand{\two}{\text{II}}
            \newcommand{\GL}{\text{GL}}
            \newcommand{\Id}{\text{Id}}
            \newcommand{\grad}[1]{\text{grad} \, #1}
            \newcommand{\gradat}[2]{\text{grad} \, #1 \, \vert_{#2}}
            \newcommand{\Hess}[1]{\text{Hess} \, #1}
            \newcommand{\T}{\text{T}}
            \newcommand{\dim}[1]{\text{dim} \, #1}
            \newcommand{\partder}[2]{\frac{\partial #1}{\partial #2}}
        </script>
    </p>






    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top is-fixed" style="background: black; border: none;">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://wiseodd.github.io/">Agustinus Kristiadi's Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                

                
                    
                        <li>
                            <a href="https://wiseodd.github.io/techblog/">Tech Blog</a>
                        </li>
                    
                
                    
                        <li>
                            <a href="https://wiseodd.github.io/travelblog/">Travel Blog</a>
                        </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li>
                            <a href="https://wiseodd.github.io/about/">About Me &amp; CV</a>
                        </li>
                    
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<!--<header class="intro-header" style="position: relative; background-image: url('/img/bayes.png');">
    <div class="overlay"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Variational Autoencoder: Intuition and Implementation</h1>
                    
                    <h2 class="subheading">Variational Autoencoder (VAE) (Kingma et al., 2013) is a new perspective in the autoencoding business. It views Autoencoder as a bayesian inference problem: modeling the underlying probability distribution of data.</h2>
                    
                    <span class="meta">Posted by wiseodd on December 10, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>-->

<!--<header>
    <div class="container">

    </div>
</header>-->

<!-- Post Content -->
<article style="padding-top: 125px;">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post">
                    <h1 style="text-align: center; font-size: 36px; padding-bottom: 2em;">Variational Autoencoder: Intuition and Implementation</h1>
                    <p>There are two generative models facing neck to neck in the data generation business right now: <a href="https://wiseodd.github.io/techblog/2016/09/17/gan-tensorflow/">Generative Adversarial Nets (GAN)</a>
 and Variational Autoencoder (VAE). These two models have different take
 on how the models are trained. GAN is rooted in game theory, its 
objective is to find the Nash Equilibrium between discriminator net and 
generator net. On the other hand, VAE is rooted in bayesian inference, 
i.e. it wants to model the underlying probability distribution of data 
so that it could sample new data from that distribution.</p>

<p>In this post, we will look at the intuition of VAE model and its implementation in Keras.</p>

<h2 class="section-heading">VAE: Formulation and Intuition</h2>

<p>Suppose we want to generate a data. Good way to do it is first to 
decide what kind of data we want to generate, then actually generate the
 data. For example, say, we want to generate an animal. First, we 
imagine the animal: it must have four legs, and it must be able to swim.
 Having those criteria, we could then actually generate the animal by 
sampling from the animal kingdom. Lo and behold, we get Platypus!</p>

<p>From the story above, our imagination is analogous to <strong>latent variable</strong>.
 It is often useful to decide the latent variable first in generative 
models, as latent variable could describe our data. Without latent 
variable, it is as if we just generate data blindly. And this is the 
difference between GAN and VAE: VAE uses latent variable, hence it’s an 
expressive model.</p>

<p>Alright, that fable is great and all, but how do we model that? Well, let’s talk about probability distribution.</p>

<p>Let’s define some notions:</p>

<ol>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-3" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-4" class="mjx-mrow"><span id="MJXc-Node-5" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> X </script>: data that we want to model a.k.a the animal</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-6" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7" class="mjx-mrow"><span id="MJXc-Node-8" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> z </script>: latent variable a.k.a our imagination</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-9" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-10" class="mjx-mrow"><span id="MJXc-Node-11" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-12" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-13" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-14" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-4"> P(X) </script>: probability distribution of the data, i.e. that animal kingdom</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-15" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-16" class="mjx-mrow"><span id="MJXc-Node-17" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-18" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-19" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-20" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5"> P(z) </script>: probability distribution of latent variable, i.e. our brain, the source of our imagination</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-21" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-22" class="mjx-mrow"><span id="MJXc-Node-23" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-24" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-25" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-26" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-27" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-28" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> P(X \vert z) </script>: distribution of generating data given latent variable, e.g. turning imagination into real animal</li>
</ol>

<p>Our objective here is to model the data, hence we want to find <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-29" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-30" class="mjx-mrow"><span id="MJXc-Node-31" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-32" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-33" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-34" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> P(X) </script>. Using the law of probability, we could find it in relation with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-35" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-36" class="mjx-mrow"><span id="MJXc-Node-37" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> z </script> as follows:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-38" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-39" class="mjx-mrow"><span id="MJXc-Node-40" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-41" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-42" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-43" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-44" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-45" class="mjx-mo MJXc-space3" style="vertical-align: 0.001em; padding-right: 0.388em;"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 1.161em; padding-bottom: 1.161em;">∫</span></span><span id="MJXc-Node-46" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-47" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-48" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-49" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-50" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-51" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-52" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-53" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-54" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-55" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-56" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em; padding-right: 0.003em;">d</span></span><span id="MJXc-Node-57" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∫</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mi>d</mi><mi>z</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-9"> P(X) = \int P(X \vert z) P(z) dz </script></p>

<p>that is, we marginalize out <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-58" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-59" class="mjx-mrow"><span id="MJXc-Node-60" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> z </script> from the joint probability distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-61" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-62" class="mjx-mrow"><span id="MJXc-Node-63" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-64" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-65" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-66" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-67" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-68" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11"> P(X, z) </script>.</p>

<p>Now if only we know <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-69" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-70" class="mjx-mrow"><span id="MJXc-Node-71" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-72" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-73" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-74" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-75" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-76" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12"> P(X, z) </script>, or equivalently, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-77" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-78" class="mjx-mrow"><span id="MJXc-Node-79" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-80" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-81" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-82" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-83" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-84" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13"> P(X \vert z) </script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-85" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-86" class="mjx-mrow"><span id="MJXc-Node-87" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-88" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-89" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-90" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-14"> P(z) </script>…</p>

<p>The idea of VAE is to infer <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-15-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-91" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-92" class="mjx-mrow"><span id="MJXc-Node-93" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-94" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-95" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-96" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15"> P(z) </script> using <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-16-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-97" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-98" class="mjx-mrow"><span id="MJXc-Node-99" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-100" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-101" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-102" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-103" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-104" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16"> P(z \vert X) </script>.
 This is make a lot of sense if we think about it: we want to make our 
latent variable likely under our data. Talking in term of our fable 
example, we want to limit our imagination only on animal kingdom domain,
 so we shouldn’t imagine about things like root, leaf, tyre, glass, GPU,
 refrigerator, doormat, … as it’s unlikely that those things have 
anything to do with things that come from the animal kingdom. Right?</p>

<p>But the problem is, we have to infer that distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-105" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-106" class="mjx-mrow"><span id="MJXc-Node-107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-108" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-109" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-111" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-112" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17"> P(z \vert X) </script>, as we don’t know it yet. In VAE, as it name suggests, we infer <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-113" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-114" class="mjx-mrow"><span id="MJXc-Node-115" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-116" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-117" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-118" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-119" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-120" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18"> P(z \vert X) </script>
 using a method called Variational Inference (VI). VI is one of the 
popular choice of method in bayesian inference, the other one being MCMC
 method. The main idea of VI is to pose the inference by approach it as 
an optimization problem. How? By modeling the true distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-121" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-122" class="mjx-mrow"><span id="MJXc-Node-123" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-124" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-125" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-126" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-127" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-128" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19"> P(z \vert X) </script>
 using simpler distribution that is easy to evaluate, e.g. Gaussian, and
 minimize the difference between those two distribution using <a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">KL divergence</a> metric, which tells us how difference it is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-129" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-130" class="mjx-mrow"><span id="MJXc-Node-131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">P</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-132" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-133" class="mjx-mrow"><span id="MJXc-Node-134" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">Q</script>.</p>

<p>Alright, now let’s say we want to infer <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-135" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-136" class="mjx-mrow"><span id="MJXc-Node-137" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-138" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-139" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-140" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-141" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-142" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22"> P(z \vert X) </script> using <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-143" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-144" class="mjx-mrow"><span id="MJXc-Node-145" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-146" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-147" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-148" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-149" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-150" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23"> Q(z \vert X) </script>. The KL divergence then formulated as follows:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;1.3em 1.3em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-151" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-152" class="mjx-mrow"><span id="MJXc-Node-153" class="mjx-mtable" style="vertical-align: -4.153em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-154" class="mjx-mtr" style="height: 3.258em;"><span id="MJXc-Node-155" class="mjx-mtd" style="padding: 0px; text-align: right; width: 9.324em;"><span id="MJXc-Node-156" class="mjx-mrow" style="margin-top: 0.511em;"><span id="MJXc-Node-157" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-158" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-159" class="mjx-texatom" style=""><span id="MJXc-Node-160" class="mjx-mrow"><span id="MJXc-Node-161" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-162" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-163" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-164" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-165" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-167" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-169" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-170" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-172" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-173" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-174" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-175" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-176" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-177" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-178" class="mjx-mtd" style="padding: 0px; text-align: left; width: 13.059em;"><span id="MJXc-Node-179" class="mjx-mrow"><span id="MJXc-Node-180" class="mjx-mi"></span><span id="MJXc-Node-181" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-182" class="mjx-munderover MJXc-space3"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-183" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.787em;"><span id="MJXc-Node-184" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span></span></span><span id="MJXc-Node-185" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-186" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-187" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-188" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-189" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-190" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-191" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-192" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-193" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-194" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 3.367em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.367em; top: -1.511em;"><span id="MJXc-Node-195" class="mjx-mrow"><span id="MJXc-Node-196" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-197" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-198" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-199" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-200" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-201" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="mjx-denominator" style="width: 3.367em; bottom: -1.011em;"><span id="MJXc-Node-202" class="mjx-mrow"><span id="MJXc-Node-203" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-204" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-205" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-206" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-207" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-208" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 3.367em;" class="mjx-line"></span></span><span style="height: 2.522em; vertical-align: -1.011em;" class="mjx-vsize"></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-209" class="mjx-mtr" style="height: 3.822em;"><span id="MJXc-Node-210" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-211" class="mjx-mrow" style="margin-top: 0.511em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-212" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-213" class="mjx-mrow"><span id="MJXc-Node-214" class="mjx-mi"></span><span id="MJXc-Node-215" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-216" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-217" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-218" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.21em; padding-bottom: 1.21em;">[</span></span><span id="MJXc-Node-219" class="mjx-mrow"><span id="MJXc-Node-220" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-221" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-222" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 3.367em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 3.367em; top: -1.511em;"><span id="MJXc-Node-223" class="mjx-mrow"><span id="MJXc-Node-224" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-225" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-226" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-227" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-228" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-229" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="mjx-denominator" style="width: 3.367em; bottom: -1.011em;"><span id="MJXc-Node-230" class="mjx-mrow"><span id="MJXc-Node-231" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-232" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-233" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-234" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-235" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-236" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 3.367em;" class="mjx-line"></span></span><span style="height: 2.522em; vertical-align: -1.011em;" class="mjx-vsize"></span></span></span><span id="MJXc-Node-237" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.21em; padding-bottom: 1.21em;">]</span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-238" class="mjx-mtr" style="height: 1.725em;"><span id="MJXc-Node-239" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-240" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-241" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-242" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-243" class="mjx-mi"></span><span id="MJXc-Node-244" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-245" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-246" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-247" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-248" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-249" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-250" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-251" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-252" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-253" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-254" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-255" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-256" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-257" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-258" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-259" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-261" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-262" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-263" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-264" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="1.3em 1.3em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><munder><mo>∑</mo><mi>z</mi></munder><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mrow><mo>[</mo><mrow><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-24">% <![CDATA[
\begin{align}

D_{KL}[Q(z \vert X) \Vert P(z \vert X)] &= \sum_z Q(z \vert X) \, \log \frac{Q(z \vert X)}{P(z \vert X)} \\[10pt]
                            &= E \left[ \log \frac{Q(z \vert X)}{P(z \vert X)} \right] \\[10pt]
                            &= E[\log Q(z \vert X) - \log P(z \vert X)]

\end{align} %]]></script>

<p>Recall the notations above, there are two things that we haven’t use, namely <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-265" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-266" class="mjx-mrow"><span id="MJXc-Node-267" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-268" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-269" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-270" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25"> P(X) </script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-271" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-272" class="mjx-mrow"><span id="MJXc-Node-273" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-274" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-275" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-276" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-277" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-278" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26"> P(X \vert z) </script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-279" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-280" class="mjx-mrow"><span id="MJXc-Node-281" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-282" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-283" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-284" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27"> P(z) </script>. But, with Bayes’ rule, we could make it appear in the equation:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;1.3em 1.3em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-285" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-286" class="mjx-mrow"><span id="MJXc-Node-287" class="mjx-mtable" style="vertical-align: -3.386em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-288" class="mjx-mtr" style="height: 3.172em;"><span id="MJXc-Node-289" class="mjx-mtd" style="padding: 0px; text-align: right; width: 9.324em;"><span id="MJXc-Node-290" class="mjx-mrow" style="margin-top: 0.511em;"><span id="MJXc-Node-291" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-292" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-293" class="mjx-texatom" style=""><span id="MJXc-Node-294" class="mjx-mrow"><span id="MJXc-Node-295" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-296" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-297" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-298" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-299" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-300" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-301" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-302" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-303" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-304" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-305" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-306" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-307" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-308" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-309" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-310" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-311" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-312" class="mjx-mtd" style="padding: 0px; text-align: left; width: 23.55em;"><span id="MJXc-Node-313" class="mjx-mrow"><span id="MJXc-Node-314" class="mjx-mi"></span><span id="MJXc-Node-315" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-316" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-317" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-318" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.21em; padding-bottom: 1.21em;">[</span></span><span id="MJXc-Node-319" class="mjx-mrow"><span id="MJXc-Node-320" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-321" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-322" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-323" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-324" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-325" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-326" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-327" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-328" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-329" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-330" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-331" class="mjx-mfrac MJXc-space1"><span class="mjx-box MJXc-stacked" style="width: 5.324em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 5.324em; top: -1.511em;"><span id="MJXc-Node-332" class="mjx-mrow"><span id="MJXc-Node-333" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-334" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-335" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-336" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-338" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-339" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-340" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-341" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-342" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="mjx-denominator" style="width: 5.324em; bottom: -1.011em;"><span id="MJXc-Node-343" class="mjx-mrow"><span id="MJXc-Node-344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-345" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-346" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-347" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 5.324em;" class="mjx-line"></span></span><span style="height: 2.522em; vertical-align: -1.011em;" class="mjx-vsize"></span></span></span><span id="MJXc-Node-348" class="mjx-mo"><span class="mjx-char MJXc-TeX-size3-R" style="padding-top: 1.21em; padding-bottom: 1.21em;">]</span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-349" class="mjx-mtr" style="height: 2.375em;"><span id="MJXc-Node-350" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-351" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-352" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-353" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-354" class="mjx-mi"></span><span id="MJXc-Node-355" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-356" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-357" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-358" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-359" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-360" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-361" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-362" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-363" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-364" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-365" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-366" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-367" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-368" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-369" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-370" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-371" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-372" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-373" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-374" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-375" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-376" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-377" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-378" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-379" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-380" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-381" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-382" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-383" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-384" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-385" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-386" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-387" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-388" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-389" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-390" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-391" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-392" class="mjx-mtr" style="height: 1.725em;"><span id="MJXc-Node-393" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-394" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-395" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-396" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-397" class="mjx-mi"></span><span id="MJXc-Node-398" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-399" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-400" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-401" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-402" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-403" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-404" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-405" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-406" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-408" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-409" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-410" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-411" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-412" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-413" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-415" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-416" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-417" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-418" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-419" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-420" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-421" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-422" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-423" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-424" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-425" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-426" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-427" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-428" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-429" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-430" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-431" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-432" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="1.3em 1.3em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mrow><mo>[</mo><mrow><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><mo>]</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-28">% <![CDATA[
\begin{align}

D_{KL}[Q(z \vert X) \Vert P(z \vert X)] &= E \left[ \log Q(z \vert X) - \log \frac{P(X \vert z) P(z)}{P(X)} \right] \\[10pt]
                                        &= E[\log Q(z \vert X) - (\log P(X \vert z) + \log P(z) - \log P(X))] \\[10pt]
                                        &= E[\log Q(z \vert X) - \log P(X \vert z) - \log P(z) + \log P(X)]

\end{align} %]]></script>

<p>Notice that the expectation is over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-433" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-434" class="mjx-mrow"><span id="MJXc-Node-435" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-29"> z </script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-436" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-437" class="mjx-mrow"><span id="MJXc-Node-438" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-440" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-441" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30"> P(X) </script> doesn’t depend on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-442" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-443" class="mjx-mrow"><span id="MJXc-Node-444" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-31"> z </script>, so we could move it outside of the expectation.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;1.3em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-445" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-446" class="mjx-mrow"><span id="MJXc-Node-447" class="mjx-mtable" style="vertical-align: -1.475em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-448" class="mjx-mtr" style="height: 1.725em;"><span id="MJXc-Node-449" class="mjx-mtd" style="padding: 0px; text-align: right; width: 14.372em;"><span id="MJXc-Node-450" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-451" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-452" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-453" class="mjx-texatom" style=""><span id="MJXc-Node-454" class="mjx-mrow"><span id="MJXc-Node-455" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-456" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-457" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-458" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-459" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-460" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-461" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-462" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-463" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-464" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-465" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-466" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-467" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-468" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-469" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-470" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-471" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-472" class="mjx-mtd" style="padding: 0px; text-align: left; width: 22.772em;"><span id="MJXc-Node-473" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-474" class="mjx-mi"></span><span id="MJXc-Node-475" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-476" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-477" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-478" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-479" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-480" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-481" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-482" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-484" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-485" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-486" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-487" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-488" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-489" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-490" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-491" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-492" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-494" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-495" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-496" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-497" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-498" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-499" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-500" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-502" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-503" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-504" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-505" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-506" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-507" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-508" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-509" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-510" class="mjx-mtr" style="height: 1.725em;"><span id="MJXc-Node-511" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-512" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-513" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-514" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-515" class="mjx-texatom" style=""><span id="MJXc-Node-516" class="mjx-mrow"><span id="MJXc-Node-517" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-518" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-519" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-520" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-521" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-522" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-523" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-524" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-525" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-526" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-527" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-528" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-529" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-530" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-531" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-532" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-533" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-534" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-535" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-536" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-537" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-538" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-539" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-540" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-541" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-542" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-543" class="mjx-mi"></span><span id="MJXc-Node-544" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-545" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-546" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-547" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-548" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-549" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-550" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-551" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-552" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-553" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-554" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-555" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-556" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-557" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-558" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-559" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-560" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-561" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-562" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-563" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-564" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-565" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-566" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-567" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-568" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-569" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-570" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-571" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="1.3em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-32">% <![CDATA[
\begin{align}

D_{KL}[Q(z \vert X) \Vert P(z \vert X)] &= E[\log Q(z \vert X) - \log P(X \vert z) - \log P(z)] + \log P(X) \\[10pt]
D_{KL}[Q(z \vert X) \Vert P(z \vert X)] - \log P(X) &= E[\log Q(z \vert X) - \log P(X \vert z) - \log P(z)]

\end{align} %]]></script>

<p>If we look carefully at the right hand side of the equation, we would
 notice that it could be rewritten as another KL divergence. So let’s do
 that by first rearranging the sign.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;1.3em 1.3em 1.3em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-572" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-573" class="mjx-mrow"><span id="MJXc-Node-574" class="mjx-mtable" style="vertical-align: -3.85em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-575" class="mjx-mtr" style="height: 1.725em;"><span id="MJXc-Node-576" class="mjx-mtd" style="padding: 0px; text-align: right; width: 14.372em;"><span id="MJXc-Node-577" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-578" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-579" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-580" class="mjx-texatom" style=""><span id="MJXc-Node-581" class="mjx-mrow"><span id="MJXc-Node-582" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-583" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-584" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-585" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-586" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-587" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-588" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-589" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-590" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-591" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-592" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-593" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-594" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-595" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-596" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-597" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-598" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-599" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-600" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-601" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-602" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-603" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-604" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-605" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-606" class="mjx-mtd" style="padding: 0px; text-align: left; width: 19.043em;"><span id="MJXc-Node-607" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-608" class="mjx-mi"></span><span id="MJXc-Node-609" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-610" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-611" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-612" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-613" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-614" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-615" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-616" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-617" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-618" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-619" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-620" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-621" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-622" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-623" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-624" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-625" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-626" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-627" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-628" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-629" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-630" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-631" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-632" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-633" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-634" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-635" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-636" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-637" class="mjx-mtr" style="height: 2.375em;"><span id="MJXc-Node-638" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-639" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-640" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-641" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-642" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-643" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-644" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-645" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-646" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-647" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-648" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-649" class="mjx-texatom" style=""><span id="MJXc-Node-650" class="mjx-mrow"><span id="MJXc-Node-651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-653" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-654" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-655" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-656" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-657" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-658" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-659" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-660" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-661" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-662" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-663" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-664" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-665" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-666" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-667" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-668" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-669" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-670" class="mjx-mi"></span><span id="MJXc-Node-671" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-672" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-673" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-674" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-675" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-676" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-677" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-678" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-679" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-680" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-681" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-682" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-683" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-684" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-685" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-686" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-687" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-688" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-689" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-690" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-691" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-692" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-693" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-694" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-695" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-696" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-697" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-698" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-699" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-700" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-701" class="mjx-mtr" style="height: 2.375em;"><span id="MJXc-Node-702" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-703" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-704" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-705" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-706" class="mjx-mi"></span><span id="MJXc-Node-707" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-708" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-709" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-710" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-711" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-712" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-713" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-714" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-715" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-716" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-717" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-718" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-719" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-720" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-721" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-722" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-723" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-724" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-725" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-727" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-728" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-729" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-730" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-731" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-732" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-733" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-734" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-735" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-736" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-737" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-738" class="mjx-mtr" style="height: 1.725em;"><span id="MJXc-Node-739" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-740" class="mjx-mrow" style="margin-top: -0.2em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-741" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-742" class="mjx-mrow" style="margin-top: -0.2em;"><span id="MJXc-Node-743" class="mjx-mi"></span><span id="MJXc-Node-744" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-745" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-746" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-747" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-748" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-749" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-750" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-751" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-752" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-753" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-754" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-755" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-756" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-757" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-758" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-759" class="mjx-texatom" style=""><span id="MJXc-Node-760" class="mjx-mrow"><span id="MJXc-Node-761" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-762" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-763" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-764" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-765" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-766" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-767" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-768" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-769" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-770" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-771" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-772" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-773" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-774" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-775" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="1.3em 1.3em 1.3em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr><mtr><mtd><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-33">% <![CDATA[
\begin{align}

D_{KL}[Q(z \vert X) \Vert P(z \vert X)] - \log P(X) &= E[\log Q(z \vert X) - \log P(X \vert z) - \log P(z)] \\[10pt]
\log P(X) - D_{KL}[Q(z \vert X) \Vert P(z \vert X)] &= E[\log P(X \vert z) - (\log Q(z \vert X) - \log P(z))] \\[10pt]
                                       &= E[\log P(X \vert z)] - E[\log Q(z \vert X) - \log P(z)] \\[10pt]
                                       &= E[\log P(X \vert z)] - D_{KL}[Q(z \vert X) \Vert P(z)]

\end{align} %]]></script>

<p>And this is it, the VAE objective function:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-776" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-777" class="mjx-mrow"><span id="MJXc-Node-778" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-779" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-780" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-781" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-782" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-783" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-784" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-785" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-786" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-787" class="mjx-texatom" style=""><span id="MJXc-Node-788" class="mjx-mrow"><span id="MJXc-Node-789" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-790" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-791" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-792" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-793" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-794" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-795" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-796" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-797" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-798" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-799" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-800" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-802" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-803" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-804" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-805" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-806" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-807" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-808" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-809" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-810" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-811" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-812" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-813" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-814" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-815" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-816" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-817" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-818" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-819" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-820" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-821" class="mjx-texatom" style=""><span id="MJXc-Node-822" class="mjx-mrow"><span id="MJXc-Node-823" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-824" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-825" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-826" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-827" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-828" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-829" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-830" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-831" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-832" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-833" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-834" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-835" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-836" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-837" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>−</mo><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-34">\log P(X) - D_{KL}[Q(z \vert X) \Vert P(z \vert X)] = E[\log P(X \vert z)] - D_{KL}[Q(z \vert X) \Vert P(z)]</script>

<p>At this point, what do we have? Let’s enumerate:</p>

<ol>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-35-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-838" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-839" class="mjx-mrow"><span id="MJXc-Node-840" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-841" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-842" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-843" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-844" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-845" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-35"> Q(z \vert X) </script> that project our data <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-846" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-847" class="mjx-mrow"><span id="MJXc-Node-848" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-36"> X </script> into latent variable space</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-849" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-850" class="mjx-mrow"><span id="MJXc-Node-851" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-37"> z </script>, the latent variable</li>
  <li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-852" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-853" class="mjx-mrow"><span id="MJXc-Node-854" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-855" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-856" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-857" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-858" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-859" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38"> P(X \vert z) </script> that generate data given latent variable</li>
</ol>

<p>We might feel familiar with this kind of structure. And guess what, it’s the same structure as seen in <a href="https://wiseodd.github.io/techblog/2016/12/03/autoencoders/">Autoencoder</a>! That is, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-39-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-860" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-861" class="mjx-mrow"><span id="MJXc-Node-862" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-863" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-864" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-865" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-866" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-867" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39"> Q(z \vert X) </script> is the encoder net, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-868" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-869" class="mjx-mrow"><span id="MJXc-Node-870" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-40"> z </script> is the encoded representation, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-871" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-872" class="mjx-mrow"><span id="MJXc-Node-873" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-874" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-875" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-876" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-877" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-878" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41"> P(X \vert z) </script> is the decoder net! Well, well, no wonder the name of this model is Variational Autoencoder!</p>

<h2 class="section-heading">VAE: Dissecting the Objective</h2>

<p>It turns out, VAE objective function has a very nice interpretation. That is, we want to model our data, which described by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-879" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-880" class="mjx-mrow"><span id="MJXc-Node-881" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-882" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-883" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-884" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-885" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-886" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42"> \log P(X) </script>, under some error <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-887" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-888" class="mjx-mrow"><span id="MJXc-Node-889" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-890" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-891" class="mjx-texatom" style=""><span id="MJXc-Node-892" class="mjx-mrow"><span id="MJXc-Node-893" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-894" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-895" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-896" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-897" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-898" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-899" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-900" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-901" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-902" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-903" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-904" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-905" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-906" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-907" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-908" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-909" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-43"> D_{KL}[Q(z \vert X) \Vert P(z \vert X)] </script>. In other words, VAE tries to find the lower bound of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-910" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-911" class="mjx-mrow"><span id="MJXc-Node-912" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-913" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-914" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-915" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-916" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-917" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44"> \log P(X) </script>, which in practice is good enough as trying to find the exact distribution is often untractable.</p>

<p>That model then could be found by maximazing over some mapping from latent variable to data <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-918" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-919" class="mjx-mrow"><span id="MJXc-Node-920" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-921" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-922" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-923" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-924" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-925" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-926" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-927" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-45"> \log P(X \vert z) </script> and minimizing the difference between our simple distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-928" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-929" class="mjx-mrow"><span id="MJXc-Node-930" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-931" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-932" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-933" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-934" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-935" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-46"> Q(z \vert X) </script> and the true latent distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-936" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-937" class="mjx-mrow"><span id="MJXc-Node-938" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-939" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-940" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-941" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-47"> P(z) </script>.</p>

<p>As we might already know, maximizing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-942" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-943" class="mjx-mrow"><span id="MJXc-Node-944" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.026em;">E</span></span><span id="MJXc-Node-945" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-946" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-947" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-948" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-949" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-950" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-951" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-952" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-953" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-954" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo stretchy="false">[</mo><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-48"> E[\log P(X \vert z)] </script>
 is a maximum likelihood estimation. We basically see it all the time in
 discriminative supervised model, for example Logistic Regression, SVM, 
or Linear Regression. In the other words, given an input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-955" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-956" class="mjx-mrow"><span id="MJXc-Node-957" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-49"> z </script> and an output <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-958" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-959" class="mjx-mrow"><span id="MJXc-Node-960" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-50"> X </script>, we want to maximize the conditional distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-961" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-962" class="mjx-mrow"><span id="MJXc-Node-963" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-964" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-965" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-966" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-967" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-968" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51"> P(X \vert z) </script> under some model parameters. So we could implement it by using any classifier with input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-969" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-970" class="mjx-mrow"><span id="MJXc-Node-971" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-52"> z </script> and output <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-972" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-973" class="mjx-mrow"><span id="MJXc-Node-974" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-53"> X </script>, then optimize the objective function by using for example log loss or regression loss.</p>

<p>What about <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-975" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-976" class="mjx-mrow"><span id="MJXc-Node-977" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-978" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-979" class="mjx-texatom" style=""><span id="MJXc-Node-980" class="mjx-mrow"><span id="MJXc-Node-981" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-982" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-983" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-984" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-985" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-986" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-987" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-988" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-989" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-990" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-991" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-992" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-993" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-994" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-995" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-54"> D_{KL}[Q(z \vert X) \Vert P(z)] </script>? Here, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-996" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-997" class="mjx-mrow"><span id="MJXc-Node-998" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-999" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1000" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1001" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-55"> P(z) </script> is the latent variable distribution. We might want to sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1002" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1003" class="mjx-mrow"><span id="MJXc-Node-1004" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1005" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1006" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1007" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56"> P(z) </script> later, so the easiest choice is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1008" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1009" class="mjx-mrow"><span id="MJXc-Node-1010" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1011" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1012" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1013" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1014" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1015" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-57"> N(0, 1) </script>. Hence, we want to make <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1016" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1017" class="mjx-mrow"><span id="MJXc-Node-1018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-1019" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1020" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1021" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-1022" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1023" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58"> Q(z \vert X) </script> to be as close as possible to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1024" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1025" class="mjx-mrow"><span id="MJXc-Node-1026" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1027" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1028" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1029" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1030" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1031" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59"> N(0, 1) </script> so that we could sample it easily.</p>

<p>Having <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1032" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1033" class="mjx-mrow"><span id="MJXc-Node-1034" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1035" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1036" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1037" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1038" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1039" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1040" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1041" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1042" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1043" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1044" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-60"> P(z) = N(0, 1) </script> also add another benefit. Let’s say we also want <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-61-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1045" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1046" class="mjx-mrow"><span id="MJXc-Node-1047" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-1048" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1049" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1050" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-1051" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1052" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-61"> Q(z \vert X) </script> to be Gaussian with parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-62-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1053" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1054" class="mjx-mrow"><span id="MJXc-Node-1055" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1056" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1057" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1058" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62"> \mu(X) </script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-63-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1059" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1060" class="mjx-mrow"><span id="MJXc-Node-1061" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1062" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1063" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1064" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63"> \Sigma(X) </script>, i.e. the mean and variance <strong>given</strong> X. Then, the KL divergence between those two distribution could be computed in closed form!</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-64-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;tr&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;det&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1065" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1066" class="mjx-mrow"><span id="MJXc-Node-1067" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1068" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1069" class="mjx-texatom" style=""><span id="MJXc-Node-1070" class="mjx-mrow"><span id="MJXc-Node-1071" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-1072" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-1073" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-1074" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1075" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1076" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1077" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1078" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1079" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1080" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1081" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1082" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1083" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1084" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1085" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1086" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-1087" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1088" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1089" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1090" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1091" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1092" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1093" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-1094" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1095" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-1096" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-1097" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.078em; vertical-align: -0.711em;" class="mjx-vsize"></span></span><span id="MJXc-Node-1098" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1099" class="mjx-mrow"><span id="MJXc-Node-1100" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.63em; padding-bottom: 0.63em;">(</span></span><span id="MJXc-Node-1101" class="mjx-mrow"><span id="MJXc-Node-1102" class="mjx-texatom"><span id="MJXc-Node-1103" class="mjx-mrow"><span id="MJXc-Node-1104" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.34em; padding-bottom: 0.34em;">tr</span></span></span></span><span id="MJXc-Node-1105" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1106" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1107" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1108" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1109" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1110" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1111" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1112" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1113" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1114" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1115" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1116" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1117" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.12em;">T</span></span></span></span><span id="MJXc-Node-1118" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1119" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1120" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1122" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1123" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span><span id="MJXc-Node-1124" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1125" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-1126" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1127" class="mjx-mo MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">det</span></span><span id="MJXc-Node-1128" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1129" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1131" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1132" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1133" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span><span id="MJXc-Node-1134" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.63em; padding-bottom: 0.63em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>,</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="thinmathspace"></mspace><mrow><mo>(</mo><mrow><mrow class="MJX-TeXAtom-ORD"><mtext>tr</mtext></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mi>k</mi><mo>−</mo><mi>log</mi><mspace width="thinmathspace"></mspace><mo movablelimits="true" form="prefix">det</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-64">D_{KL}[N(\mu(X), \Sigma(X)) \Vert N(0, 1)] = \frac{1}{2} \, \left( \textrm{tr}(\Sigma(X)) + \mu(X)^T\mu(X) - k - \log \, \det(\Sigma(X)) \right)</script>

<p>Above, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-65-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1135" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1136" class="mjx-mrow"><span id="MJXc-Node-1137" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-65"> k </script> is the dimension of our Gaussian. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-66-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;tr&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1138" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1139" class="mjx-mrow"><span id="MJXc-Node-1140" class="mjx-texatom"><span id="MJXc-Node-1141" class="mjx-mrow"><span id="MJXc-Node-1142" class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.34em; padding-bottom: 0.34em;">tr</span></span></span></span><span id="MJXc-Node-1143" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1144" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1145" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mtext>tr</mtext></mrow><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-66"> \textrm{tr}(X) </script> is trace function, i.e. sum of the diagonal of matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-67-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1146" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1147" class="mjx-mrow"><span id="MJXc-Node-1148" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-67"> X </script>. The determinant of a diagonal matrix could be computed as product of its diagonal. So really, we could implement <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-68-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1149" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1150" class="mjx-mrow"><span id="MJXc-Node-1151" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1152" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1153" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1154" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-68"> \Sigma(X) </script> as just a vector as it’s a diagonal matrix:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-69-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;1.3em 1.3em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1155" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1156" class="mjx-mrow"><span id="MJXc-Node-1157" class="mjx-mtable" style="vertical-align: -5.422em; padding: 0px 0.167em;"><span class="mjx-table"><span id="MJXc-Node-1158" class="mjx-mtr" style="height: 3.701em;"><span id="MJXc-Node-1159" class="mjx-mtd" style="padding: 0px; text-align: right; width: 12.836em;"><span id="MJXc-Node-1160" class="mjx-mrow" style="margin-top: 0.775em;"><span id="MJXc-Node-1161" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1162" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1163" class="mjx-texatom" style=""><span id="MJXc-Node-1164" class="mjx-mrow"><span id="MJXc-Node-1165" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-1166" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-1167" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-1168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1169" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1170" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1171" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1172" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1174" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1175" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1176" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1177" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1178" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1179" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1180" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-1181" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1182" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1183" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1184" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1185" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1186" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1187" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1188" class="mjx-mtd" style="padding: 0px; text-align: left; width: 22.794em;"><span id="MJXc-Node-1189" class="mjx-mrow"><span id="MJXc-Node-1190" class="mjx-mi"></span><span id="MJXc-Node-1191" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1192" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-1193" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-1194" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.078em; vertical-align: -0.711em;" class="mjx-vsize"></span></span><span id="MJXc-Node-1195" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1196" class="mjx-mrow"><span id="MJXc-Node-1197" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.548em; padding-bottom: 1.548em;">(</span></span><span id="MJXc-Node-1198" class="mjx-mrow"><span id="MJXc-Node-1199" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1200" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1201" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1202" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1203" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1204" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1205" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1206" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1207" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1208" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1209" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1210" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1211" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1212" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span></span><span id="MJXc-Node-1213" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1214" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1215" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1216" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1217" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1218" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1219" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1220" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1221" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1222" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-1223" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1224" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1225" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∏</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.643em;"><span id="MJXc-Node-1226" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1227" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1228" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1229" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1230" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span><span id="MJXc-Node-1231" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.548em; padding-bottom: 1.548em;">)</span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1232" class="mjx-mtr" style="height: 4.351em;"><span id="MJXc-Node-1233" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-1234" class="mjx-mrow" style="margin-top: 0.775em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1235" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-1236" class="mjx-mrow"><span id="MJXc-Node-1237" class="mjx-mi"></span><span id="MJXc-Node-1238" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1239" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-1240" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-1241" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.078em; vertical-align: -0.711em;" class="mjx-vsize"></span></span><span id="MJXc-Node-1242" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1243" class="mjx-mrow"><span id="MJXc-Node-1244" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.548em; padding-bottom: 1.548em;">(</span></span><span id="MJXc-Node-1245" class="mjx-mrow"><span id="MJXc-Node-1246" class="mjx-munderover"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1247" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1248" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1249" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1250" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1251" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1252" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1253" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1254" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1255" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1256" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1257" class="mjx-msubsup MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-1258" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1259" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span></span><span id="MJXc-Node-1260" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1261" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1262" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1263" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1264" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1265" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1266" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1267" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1268" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1269" class="mjx-munderover MJXc-space2"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1270" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1271" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1272" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-1273" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1274" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1275" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1276" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1277" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span><span id="MJXc-Node-1278" class="mjx-mo"><span class="mjx-char MJXc-TeX-size4-R" style="padding-top: 1.548em; padding-bottom: 1.548em;">)</span></span></span><span class="mjx-strut"></span></span></span></span><span id="MJXc-Node-1279" class="mjx-mtr" style="height: 3.293em;"><span id="MJXc-Node-1280" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: right;"><span id="MJXc-Node-1281" class="mjx-mrow" style="margin-top: 0.368em;"><span class="mjx-strut"></span></span></span><span id="MJXc-Node-1282" class="mjx-mtd" style="padding: 0.65em 0px 0px; text-align: left;"><span id="MJXc-Node-1283" class="mjx-mrow"><span id="MJXc-Node-1284" class="mjx-mi"></span><span id="MJXc-Node-1285" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1286" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-1287" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-1288" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.078em; vertical-align: -0.711em;" class="mjx-vsize"></span></span><span id="MJXc-Node-1289" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1290" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1291" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1292" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1293" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1294" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.63em; padding-bottom: 0.63em;">(</span></span><span id="MJXc-Node-1295" class="mjx-mrow"><span id="MJXc-Node-1296" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1297" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1298" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1299" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1300" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1301" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1302" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1303" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span></span><span id="MJXc-Node-1304" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1305" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1306" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1307" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1308" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1309" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1310" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-1311" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1312" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1313" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1314" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1315" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span><span id="MJXc-Node-1316" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.63em; padding-bottom: 0.63em;">)</span></span></span><span class="mjx-strut"></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="1.3em 1.3em 0.3em" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>,</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="thinmathspace"></mspace><mrow><mo>(</mo><mrow><munder><mo>∑</mo><mi>k</mi></munder><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><munder><mo>∑</mo><mi>k</mi></munder><msup><mi>μ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><munder><mo>∑</mo><mi>k</mi></munder><mn>1</mn><mo>−</mo><mi>log</mi><mspace width="thinmathspace"></mspace><munder><mo>∏</mo><mi>k</mi></munder><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="thinmathspace"></mspace><mrow><mo>(</mo><mrow><munder><mo>∑</mo><mi>k</mi></munder><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><munder><mo>∑</mo><mi>k</mi></munder><msup><mi>μ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><munder><mo>∑</mo><mi>k</mi></munder><mn>1</mn><mo>−</mo><munder><mo>∑</mo><mi>k</mi></munder><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="thinmathspace"></mspace><munder><mo>∑</mo><mi>k</mi></munder><mrow><mo>(</mo><mrow><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>μ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo>−</mo><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-69">% <![CDATA[
\begin{align}

D_{KL}[N(\mu(X), \Sigma(X)) \Vert N(0, 1)] &= \frac{1}{2} \, \left( \sum_k \Sigma(X) + \sum_k \mu^2(X) - \sum_k 1 - \log \, \prod_k \Sigma(X) \right) \\[10pt]
                                      &= \frac{1}{2} \, \left( \sum_k \Sigma(X) + \sum_k \mu^2(X) - \sum_k 1 - \sum_k \log \Sigma(X) \right) \\[10pt]
                                      &= \frac{1}{2} \, \sum_k \left( \Sigma(X) + \mu^2(X) - 1 - \log \Sigma(X) \right)
\end{align} %]]></script>

<p>In practice, however, it’s better to model <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-70-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1317" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1318" class="mjx-mrow"><span id="MJXc-Node-1319" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1320" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1321" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1322" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-70"> \Sigma(X) </script> as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-71-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1323" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1324" class="mjx-mrow"><span id="MJXc-Node-1325" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.534em;">log</span></span><span id="MJXc-Node-1326" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1327" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1328" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1329" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1330" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>log</mi><mo>⁡</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71"> \log \Sigma(X) </script>, as it is more numerically stable to take exponent compared to computing log. Hence, our final KL divergence term is:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-72-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1331" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1332" class="mjx-mrow"><span id="MJXc-Node-1333" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1334" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1335" class="mjx-texatom" style=""><span id="MJXc-Node-1336" class="mjx-mrow"><span id="MJXc-Node-1337" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-1338" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em;">L</span></span></span></span></span></span><span id="MJXc-Node-1339" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">[</span></span><span id="MJXc-Node-1340" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1341" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1342" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1343" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1344" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1345" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1346" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1347" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1348" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1349" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1350" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1351" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1352" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">∥</span></span><span id="MJXc-Node-1353" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1354" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1355" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1356" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1357" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1358" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1359" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">]</span></span><span id="MJXc-Node-1360" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1361" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 0.7em; padding: 0px 0.12em;"><span class="mjx-numerator" style="width: 0.7em; top: -1.368em;"><span id="MJXc-Node-1362" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="width: 0.7em; bottom: -0.711em;"><span id="MJXc-Node-1363" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.3px solid; top: -0.28em; width: 0.7em;" class="mjx-line"></span></span><span style="height: 2.078em; vertical-align: -0.711em;" class="mjx-vsize"></span></span><span id="MJXc-Node-1364" class="mjx-munderover MJXc-space1"><span class="mjx-itable"><span class="mjx-row"><span class="mjx-cell"><span class="mjx-op"><span id="MJXc-Node-1365" class="mjx-mo"><span class="mjx-char MJXc-TeX-size2-R" style="padding-top: 0.727em; padding-bottom: 0.727em;">∑</span></span></span></span></span><span class="mjx-row"><span class="mjx-under" style="font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.761em;"><span id="MJXc-Node-1366" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em;">k</span></span></span></span></span></span><span id="MJXc-Node-1367" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-1368" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.63em; padding-bottom: 0.63em;">(</span></span><span id="MJXc-Node-1369" class="mjx-mrow"><span id="MJXc-Node-1370" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.147em; padding-bottom: 0.534em;">exp</span></span><span id="MJXc-Node-1371" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-1372" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1373" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1374" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1375" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1376" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1377" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1378" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1379" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1380" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1381" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span></span><span id="MJXc-Node-1382" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1383" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1384" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1385" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1386" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1387" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">−</span></span><span id="MJXc-Node-1388" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1389" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1390" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1391" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span><span id="MJXc-Node-1392" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.63em; padding-bottom: 0.63em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>D</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">(</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>,</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="false">‖</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munder><mo>∑</mo><mi>k</mi></munder><mrow><mo>(</mo><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msup><mi>μ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo>−</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><mo>)</mo></mrow></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-72">D_{KL}[N(\mu(X), \Sigma(X)) \Vert N(0, 1)] = \frac{1}{2} \sum_k \left( \exp(\Sigma(X)) + \mu^2(X) - 1 - \Sigma(X) \right)</script>

<h2 class="section-heading">Implementation in Keras</h2>

<p>First, let’s implement the encoder net <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-73-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1393" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1394" class="mjx-mrow"><span id="MJXc-Node-1395" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-1396" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1397" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1398" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-1399" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1400" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73"> Q(z \vert X) </script>, which takes input <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-74-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1401" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1402" class="mjx-mrow"><span id="MJXc-Node-1403" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-74"> X </script> and outputting two things: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-75-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1404" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1405" class="mjx-mrow"><span id="MJXc-Node-1406" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1407" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1408" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1409" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-75"> \mu(X) </script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-76-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1410" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1411" class="mjx-mrow"><span id="MJXc-Node-1412" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1413" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1414" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1415" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Σ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-76"> \Sigma(X) </script>, the parameters of the Gaussian.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Lambda</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">keras.objectives</span> <span class="kn">import</span> <span class="n">binary_crossentropy</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">LearningRateScheduler</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">keras.backend</span> <span class="k">as</span> <span class="n">K</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>


<span class="n">m</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">n_z</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n_epoch</span> <span class="o">=</span> <span class="mi">10</span>


<span class="c"># Q(z|X) -- encoder</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,))</span>
<span class="n">h_q</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">n_z</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'linear'</span><span class="p">)(</span><span class="n">h_q</span><span class="p">)</span>
<span class="n">log_sigma</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">n_z</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'linear'</span><span class="p">)(</span><span class="n">h_q</span><span class="p">)</span>
</code></pre></div></div>

<p>That is, our <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-77-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1416" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1417" class="mjx-mrow"><span id="MJXc-Node-1418" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-1419" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1420" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1421" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-1422" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1423" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-77"> Q(z \vert X) </script>
 is a neural net with one hidden layer. In this implementation, our 
latent variable is two dimensional, so that we could easily visualize 
it. In practice though, more dimension in latent variable should be 
better.</p>

<p>However, we are now facing a problem. How do we get <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-78-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1424" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1425" class="mjx-mrow"><span id="MJXc-Node-1426" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-78"> z </script> from the encoder outputs? Obviously we could sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-79-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1427" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1428" class="mjx-mrow"><span id="MJXc-Node-1429" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-79"> z </script>
 from a Gaussian which parameters are the outputs of the encoder. Alas, 
sampling directly won’t do, if we want to train VAE with gradient 
descent as the sampling operation doesn’t have gradient!</p>

<p>There is, however a trick called reparameterization trick, which 
makes the network differentiable. Reparameterization trick basically 
divert the non-differentiable operation out of the network, so that, 
even though we still involve a thing that is non-differentiable, at 
least it is out of the network, hence the network could still be 
trained.</p>

<p>The reparameterization trick is as follows. Recall, if we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-80-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1430" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1431" class="mjx-mrow"><span id="MJXc-Node-1432" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em;">x</span></span><span id="MJXc-Node-1433" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">∼</span></span><span id="MJXc-Node-1434" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1435" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1436" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1437" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1438" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mi>μ</mi><mo>,</mo><mi mathvariant="normal">Σ</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-80"> x \sim N(\mu, \Sigma) </script> and then standardize it so that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-81-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1440" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1441" class="mjx-mrow"><span id="MJXc-Node-1442" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1443" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1444" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1445" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1446" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span><span id="MJXc-Node-1447" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1448" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal">Σ</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-81"> \mu = 0, \Sigma = 1 </script>, we could revert it back to the original distribution by reverting the standardization process. Hence, we have this equation:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-82-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1449" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1450" class="mjx-mrow"><span id="MJXc-Node-1451" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em;">x</span></span><span id="MJXc-Node-1452" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1453" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1454" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1455" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1456" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.588em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1457" class="mjx-texatom" style=""><span id="MJXc-Node-1458" class="mjx-mrow"><span id="MJXc-Node-1459" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.318em;"><span id="MJXc-Node-1460" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.61em;"><span id="MJXc-Node-1461" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.2px solid; top: -0.292em; width: 0.495em;" class="mjx-line"></span></span><span style="height: 1.363em; vertical-align: -0.432em;" class="mjx-vsize"></span></span></span></span></span></span><span id="MJXc-Node-1462" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1463" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1464" class="mjx-texatom" style=""><span id="MJXc-Node-1465" class="mjx-mrow"><span id="MJXc-Node-1466" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em;">s</span></span><span id="MJXc-Node-1467" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.389em; padding-bottom: 0.292em;">t</span></span><span id="MJXc-Node-1468" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.292em; padding-right: 0.003em;">d</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mi>μ</mi><mo>+</mo><msup><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>t</mi><mi>d</mi></mrow></msub></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-82">x = \mu + \Sigma^{\frac{1}{2}} x_{std}</script>

<p>With that in mind, we could extend it. If we sample from a standard 
normal distribution, we could convert it to any Gaussian we want if we 
know the mean and the variance. Hence we could implement our sampling 
operation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-83-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1469" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1470" class="mjx-mrow"><span id="MJXc-Node-1471" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-83"> z </script> by:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="mjx-chtml MJXc-display" style="text-align: center;"><span id="MathJax-Element-84-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A3;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1472" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1473" class="mjx-mrow"><span id="MJXc-Node-1474" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1475" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">=</span></span><span id="MJXc-Node-1476" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.485em;">μ</span></span><span id="MJXc-Node-1477" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1478" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1479" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1480" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.292em; padding-bottom: 0.437em;">+</span></span><span id="MJXc-Node-1481" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1482" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">Σ</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.588em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1483" class="mjx-texatom" style=""><span id="MJXc-Node-1484" class="mjx-mrow"><span id="MJXc-Node-1485" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.495em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 0.7em; top: -1.318em;"><span id="MJXc-Node-1486" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 0.7em; bottom: -0.61em;"><span id="MJXc-Node-1487" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">2</span></span></span><span style="border-bottom: 1.2px solid; top: -0.292em; width: 0.495em;" class="mjx-line"></span></span><span style="height: 1.363em; vertical-align: -0.432em;" class="mjx-vsize"></span></span></span></span></span></span><span id="MJXc-Node-1488" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1489" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1490" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span><span id="MJXc-Node-1491" class="mjx-mspace" style="width: 0.167em; height: 0px;"></span><span id="MJXc-Node-1492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em;">ϵ</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi mathvariant="normal">Σ</mi><mrow class="MJX-TeXAtom-ORD"><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mspace width="thinmathspace"></mspace><mi>ϵ</mi></math></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-84">z = \mu(X) + \Sigma^{\frac{1}{2}}(X) \, \epsilon</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-85-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03F5;&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1493" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1494" class="mjx-mrow"><span id="MJXc-Node-1495" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em;">ϵ</span></span><span id="MJXc-Node-1496" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">∼</span></span><span id="MJXc-Node-1497" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1498" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1499" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1500" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1501" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1502" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϵ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-85"> \epsilon \sim N(0, 1) </script>.</p>

<p>Now, during backpropagation, we don’t care anymore with the sampling 
process, as it is now outside of the network, i.e. doesn’t depend on 
anything in the net, hence the gradient won’t flow through it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sample_z</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">log_sigma</span> <span class="o">=</span> <span class="n">args</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">random_normal</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n_z</span><span class="p">),</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">K</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">eps</span>


<span class="c"># Sample z ~ Q(z|X)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">(</span><span class="n">sample_z</span><span class="p">)([</span><span class="n">mu</span><span class="p">,</span> <span class="n">log_sigma</span><span class="p">])</span>
</code></pre></div></div>

<p>Now we create the decoder net <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-86-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1503" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1504" class="mjx-mrow"><span id="MJXc-Node-1505" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-1506" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1507" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1508" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-1509" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1510" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo fence="false" stretchy="false">|</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-86"> P(X \vert z) </script>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># P(X|z) -- decoder</span>
<span class="n">decoder_hidden</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">)</span>
<span class="n">decoder_out</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">)</span>

<span class="n">h_p</span> <span class="o">=</span> <span class="n">decoder_hidden</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">decoder_out</span><span class="p">(</span><span class="n">h_p</span><span class="p">)</span>
</code></pre></div></div>

<p>Lastly, from this model, we can do three things: reconstruct inputs, 
encode inputs into latent variables, and generate data from latent 
variable. So, we have three Keras models:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Overall VAE model, for reconstruction and training</span>
<span class="n">vae</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">)</span>

<span class="c"># Encoder model, to encode input into latent variable</span>
<span class="c"># We use the mean as the output as it is the center point, the representative of the gaussian</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>

<span class="c"># Generator model, generate new data given latent variable z</span>
<span class="n">d_in</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_z</span><span class="p">,))</span>
<span class="n">d_h</span> <span class="o">=</span> <span class="n">decoder_hidden</span><span class="p">(</span><span class="n">d_in</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">decoder_out</span><span class="p">(</span><span class="n">d_h</span><span class="p">)</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">)</span>
</code></pre></div></div>

<p>Then, we need to translate our loss into Keras code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">vae_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="s">""" Calculate loss = reconstruction loss + KL loss for each data in minibatch """</span>
    <span class="c"># E[log P(X|z)]</span>
    <span class="n">recon</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">binary_crossentropy</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c"># D_KL(Q(z|X) || P(z|X)); calculate in closed form as both dist. are Gaussian</span>
    <span class="n">kl</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">K</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_sigma</span><span class="p">)</span> <span class="o">+</span> <span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">-</span> <span class="n">log_sigma</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">recon</span> <span class="o">+</span> <span class="n">kl</span>
</code></pre></div></div>

<p>and then train it:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vae</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">vae_loss</span><span class="p">)</span>
<span class="n">vae</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="n">n_epoch</span><span class="p">)</span>
</code></pre></div></div>

<p>And that’s it, the implementation of VAE in Keras!</p>

<h2 class="section-heading">Implementation on MNIST Data</h2>

<p>We could use any dataset really, but like always, we will use MNIST as an example.</p>

<p>After we trained our VAE model, we then could visualize the latent variable space <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-87-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1511" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1512" class="mjx-mrow"><span id="MJXc-Node-1513" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.485em; padding-bottom: 0.485em;">Q</span></span><span id="MJXc-Node-1514" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1515" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1516" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">|</span></span><span id="MJXc-Node-1517" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.024em;">X</span></span><span id="MJXc-Node-1518" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mo fence="false" stretchy="false">|</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-87"> Q(z \vert X) </script>:</p>

<p><img src="readme_files/z_dist.png" alt="Q(z \vert X)" class="img-responsive"></p>

<p>As we could see, in the latent space, the representation of our data 
that have the same characteristic, e.g. same label, are close to each 
other. Notice that in the training phase, we never provide any 
information regarding the data.</p>

<p>We could also look at the data reconstruction by running through the data into overall VAE net:</p>

<p><img src="readme_files/reconstruction.png" alt="Reconstruction" class="img-responsive"></p>

<p>Lastly, we could generate new sample by first sample <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-88-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;&amp;#x223C;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1519" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1520" class="mjx-mrow"><span id="MJXc-Node-1521" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.196em; padding-bottom: 0.292em; padding-right: 0.003em;">z</span></span><span id="MJXc-Node-1522" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.099em; padding-bottom: 0.34em;">∼</span></span><span id="MJXc-Node-1523" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1524" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1525" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1526" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1527" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1528" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-88"> z \sim N(0, 1) </script> and feed it into our decoder net:</p>

<p><img src="readme_files/generation.png" alt="Generation" class="img-responsive"></p>

<p>If we look closely on the reconstructed and generated data, we would 
notice that some of the data are ambiguous. For example the digit 5 
looks like 3 or 8. That’s because our latent variable space is a 
continous distribution (i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-89-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 109%; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><span id="MJXc-Node-1529" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1530" class="mjx-mrow"><span id="MJXc-Node-1531" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.437em; padding-bottom: 0.292em; padding-right: 0.085em;">N</span></span><span id="MJXc-Node-1532" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">(</span></span><span id="MJXc-Node-1533" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">0</span></span><span id="MJXc-Node-1534" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.142em; padding-bottom: 0.534em;">,</span></span><span id="MJXc-Node-1535" class="mjx-mn MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.389em; padding-bottom: 0.34em;">1</span></span><span id="MJXc-Node-1536" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.485em; padding-bottom: 0.582em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-89"> N(0, 1) </script>),
 hence there bound to be some smooth transition on the edge of the 
clusters. And also, the cluster of digits are close to each other if 
they are somewhat similar. That’s why in the latent space, 5 is close to
 3.</p>

<h2 class="section-heading">Conclusion</h2>

<p>In this post we looked at the intuition behind Variational Autoencoder (VAE), its formulation, and its implementation in Keras.</p>

<p>We also saw the difference between VAE and GAN, the two most popular generative models nowadays.</p>

<p>For more math on VAE, be sure to hit the original paper by Kingma et 
al., 2014. There is also an excellent tutorial on VAE by Carl Doersch. 
Check out the references section below.</p>

<p>The full code is available in my repo: <a href="https://github.com/wiseodd/generative-models">https://github.com/wiseodd/generative-models</a></p>

<h2 class="section-heading">References</h2>

<ol>
  <li>Doersch, Carl. “Tutorial on variational autoencoders.” arXiv preprint arXiv:1606.05908 (2016).</li>
  <li>Kingma, Diederik P., and Max Welling. “Auto-encoding variational bayes.” arXiv preprint arXiv:1312.6114 (2013).</li>
  <li><a href="https://blog.keras.io/building-autoencoders-in-keras.html">https://blog.keras.io/building-autoencoders-in-keras.html</a></li>
</ol>

                </div>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="https://wiseodd.github.io/techblog/2016/12/05/contractive-autoencoder/" data-toggle="tooltip" data-placement="top" title="" data-original-title="Deriving Contractive Autoencoder and Implementing it in Keras">← Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="https://wiseodd.github.io/techblog/2016/12/17/conditional-vae/" data-toggle="tooltip" data-placement="top" title="" data-original-title="Conditional Variational Autoencoder: Intuition and Implementation">Next Post →</a>
                    </li>
                    
                </ul>

                <hr>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="https://wiseodd.github.io/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/wiseodd">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright © Agustinus Kristiadi's Blog 2019</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="readme_files/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="readme_files/bootstrap.js"></script>

<!-- Custom Theme JavaScript -->
<script src="readme_files/clean-blog.js"></script>

<script src="readme_files/MathJax.js" id=""></script>

<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
    }
  });
</script>





</body></html>